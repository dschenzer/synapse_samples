{
	"name": "TPC",
	"properties": {
		"content": {
			"query": "-- Used for Serverless and SQL Server with columnstore\nSELECT\n    --Query01\n    l_returnflag,\n    l_linestatus,\n    SUM(l_quantity) AS sum_qty,\n    SUM(l_extendedprice) AS sum_base_price,\n    SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price,\n    SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge,\n    AVG(l_quantity) AS avg_qty,\n    AVG(l_extendedprice) AS avg_price,\n    AVG(l_discount) AS avg_disc,\n    COUNT(*) AS count_order\nFROM [dbo].[lineitem]\nWHERE\n    l_shipdate <= CAST('1998-09-02' AS date)\nGROUP BY\n    l_returnflag,\n    l_linestatus\nORDER BY\n    l_returnflag,\n    l_linestatus;\n\n\nSELECT\n    --Query02\n\ttop 100\n    s_acctbal,\n    s_name,\n    n_name,\n    p_partkey,\n    p_mfgr,\n    s_address,\n    s_phone,\n    s_comment\nFROM\n    part,\n    supplier,\n    partsupp,\n    nation,\n    region\nWHERE\n    p_partkey = ps_partkey\n    AND s_suppkey = ps_suppkey\n    AND p_size = 15\n    AND p_type LIKE '%BRASS'\n    AND s_nationkey = n_nationkey\n    AND n_regionkey = r_regionkey\n    AND r_name = 'EUROPE'\n    AND ps_supplycost = (\n        SELECT\n            MIN(ps_supplycost)\n        FROM\n            partsupp,\n            supplier,\n            nation,\n            region\n        WHERE\n            p_partkey = ps_partkey\n            AND s_suppkey = ps_suppkey\n            AND s_nationkey = n_nationkey\n            AND n_regionkey = r_regionkey\n            AND r_name = 'EUROPE'\n    )\nORDER BY\n    s_acctbal DESC,\n    n_name,\n    s_name,\n    p_partkey\n\n\nSELECT\n    --Query03\n\ttop(10)\n    l_orderkey,\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue,\n    o_orderdate,\n    o_shippriority\nFROM\n    customer,\n    orders,\n    lineitem\nWHERE\n    c_mktsegment = 'BUILDING'\n    AND c_custkey = o_custkey\n    AND l_orderkey = o_orderkey\n    AND o_orderdate < CAST('1995-03-15' AS date)\n    AND l_shipdate > CAST('1995-03-15' AS date)\nGROUP BY\n    l_orderkey,\n    o_orderdate,\n    o_shippriority\nORDER BY\n    revenue DESC,\n    o_orderdate\n\n\n\n\nSELECT\n    --Query04\n    o_orderpriority,\n    COUNT(*) AS order_count\nFROM\n    orders\nWHERE\n    o_orderdate >= CAST('1993-07-01' AS date)\n    AND o_orderdate < CAST('1993-10-01' AS date)\n    AND EXISTS (\n        SELECT\n            *\n        FROM\n            lineitem\n        WHERE\n            l_orderkey = o_orderkey\n            AND l_commitdate < l_receiptdate\n    )\nGROUP BY\n    o_orderpriority\nORDER BY\n    o_orderpriority;\n\n\nSELECT\n    --Query05\n    n_name,\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM\n    customer,\n    orders,\n    lineitem,\n    supplier,\n    nation,\n    region\nWHERE\n    c_custkey = o_custkey\n    AND l_orderkey = o_orderkey\n    AND l_suppkey = s_suppkey\n    AND c_nationkey = s_nationkey\n    AND s_nationkey = n_nationkey\n    AND n_regionkey = r_regionkey\n    AND r_name = 'ASIA'\n    AND o_orderdate >= CAST('1994-01-01' AS date)\n    AND o_orderdate < CAST('1995-01-01' AS date)\nGROUP BY\n    n_name\nORDER BY\n    revenue DESC;\n\n\n\nSELECT\n    --Query06\n    SUM(l_extendedprice * l_discount) AS revenue\nFROM\n    lineitem\nWHERE\n    l_shipdate >= CAST('1994-01-01' AS date)\n    AND l_shipdate < CAST('1995-01-01' AS date)\n    AND l_discount BETWEEN 0.05\n    AND 0.07\n    AND l_quantity < 24;\n\n\nSELECT\n    --Query07\n    supp_nation,\n    cust_nation,\n    l_year,\n    SUM(volume) AS revenue\nFROM\n    (\n        SELECT\n            n1.n_name AS supp_nation,\n            n2.n_name AS cust_nation,\n            YEAR(\n                l_shipdate\n            ) AS l_year,\n            l_extendedprice * (1 - l_discount) AS volume\n        FROM\n            supplier,\n            lineitem,\n            orders,\n            customer,\n            nation n1,\n            nation n2\n        WHERE\n            s_suppkey = l_suppkey\n            AND o_orderkey = l_orderkey\n            AND c_custkey = o_custkey\n            AND s_nationkey = n1.n_nationkey\n            AND c_nationkey = n2.n_nationkey\n            AND (\n                (\n                    n1.n_name = 'FRANCE'\n                    AND n2.n_name = 'GERMANY'\n                )\n                OR (\n                    n1.n_name = 'GERMANY'\n                    AND n2.n_name = 'FRANCE'\n                )\n            )\n            AND l_shipdate BETWEEN CAST('1995-01-01' AS date)\n            AND CAST('1996-12-31' AS date)\n    ) AS shipping\nGROUP BY\n    supp_nation,\n    cust_nation,\n    l_year\nORDER BY\n    supp_nation,\n    cust_nation,\n    l_year;\n\n\nSELECT\n    --Query08\n    o_year,\n    SUM(\n        CASE\n            WHEN nation = 'BRAZIL' THEN volume\n            ELSE 0\n        END\n    ) / SUM(volume) AS mkt_share\nFROM\n    (\n        SELECT\n            \n                year (\n                o_orderdate\n            ) AS o_year,\n            l_extendedprice * (1 - l_discount) AS volume,\n            n2.n_name AS nation\n        FROM\n            part,\n            supplier,\n            lineitem,\n            orders,\n            customer,\n            nation n1,\n            nation n2,\n            region\n        WHERE\n            p_partkey = l_partkey\n            AND s_suppkey = l_suppkey\n            AND l_orderkey = o_orderkey\n            AND o_custkey = c_custkey\n            AND c_nationkey = n1.n_nationkey\n            AND n1.n_regionkey = r_regionkey\n            AND r_name = 'AMERICA'\n            AND s_nationkey = n2.n_nationkey\n            AND o_orderdate BETWEEN CAST('1995-01-01' AS date)\n            AND CAST('1996-12-31' AS date)\n            AND p_type = 'ECONOMY ANODIZED STEEL'\n    ) AS all_nations\nGROUP BY\n    o_year\nORDER BY\n    o_year;\n\n\nSELECT\n    --Query09\n    nation,\n    o_year,\n    SUM(amount) AS sum_profit\nFROM\n    (\n        SELECT\n            n_name AS nation,\n            \n                year (\n                \n                    o_orderdate\n            ) AS o_year,\n            l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity AS amount\n        FROM\n            part,\n            supplier,\n            lineitem,\n            partsupp,\n            orders,\n            nation\n        WHERE\n            s_suppkey = l_suppkey\n            AND ps_suppkey = l_suppkey\n            AND ps_partkey = l_partkey\n            AND p_partkey = l_partkey\n            AND o_orderkey = l_orderkey\n            AND s_nationkey = n_nationkey\n            AND p_name LIKE '%green%'\n    ) AS profit\nGROUP BY\n    nation,\n    o_year\nORDER BY\n    nation,\n    o_year DESC;\n\n\nSELECT\n    --Query10\n\ttop 20\n    c_custkey,\n    c_name,\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue,\n    c_acctbal,\n    n_name,\n    c_address,\n    c_phone,\n    c_comment\nFROM\n    customer,\n    orders,\n    lineitem,\n    nation\nWHERE\n    c_custkey = o_custkey\n    AND l_orderkey = o_orderkey\n    AND o_orderdate >= CAST('1993-10-01' AS date)\n    AND o_orderdate < CAST('1994-01-01' AS date)\n    AND l_returnflag = 'R'\n    AND c_nationkey = n_nationkey\nGROUP BY\n    c_custkey,\n    c_name,\n    c_acctbal,\n    c_phone,\n    n_name,\n    c_address,\n    c_comment\nORDER BY\n    revenue DESC;\n\n\nSELECT\n    --Query11\n    ps_partkey,\n    SUM(ps_supplycost * ps_availqty) AS value\nFROM\n    partsupp,\n    supplier,\n    nation\nWHERE\n    ps_suppkey = s_suppkey\n    AND s_nationkey = n_nationkey\n    AND n_name = 'GERMANY'\nGROUP BY\n    ps_partkey\nHAVING\n    SUM(ps_supplycost * ps_availqty) > (\n        SELECT\n            SUM(ps_supplycost * ps_availqty) * (0.0001/10)\n            -- SUM(ps_supplycost * ps_availqty) * 1\n        FROM\n            partsupp,\n            supplier,\n            nation\n        WHERE\n            ps_suppkey = s_suppkey\n            AND s_nationkey = n_nationkey\n            AND n_name = 'GERMANY'\n    )\nORDER BY\n    value DESC;\n    \n    \n\nSELECT\n    --Query12\n    l_shipmode,\n    SUM(\n        CASE\n            WHEN o_orderpriority = '1-URGENT'\n            OR o_orderpriority = '2-HIGH' THEN 1\n            ELSE 0\n        END\n    ) AS high_line_count,\n    SUM(\n        CASE\n            WHEN o_orderpriority <> '1-URGENT'\n            AND o_orderpriority <> '2-HIGH' THEN 1\n            ELSE 0\n        END\n    ) AS low_line_count\nFROM\n    orders,\n    lineitem\nWHERE\n    o_orderkey = l_orderkey\n    AND l_shipmode IN ('MAIL', 'SHIP')\n    AND l_commitdate < l_receiptdate\n    AND l_shipdate < l_commitdate\n    AND l_receiptdate >= CAST('1994-01-01' AS date)\n    AND l_receiptdate < CAST('1995-01-01' AS date)\nGROUP BY\n    l_shipmode\nORDER BY\n    l_shipmode;\n\n\nSELECT\n    --Query13\n    c_count,\n    COUNT(*) AS custdist\nFROM\n    (\n        SELECT\n            c_custkey,\n            COUNT(o_orderkey) AS c_count\n        FROM\n            customer\n            LEFT OUTER JOIN orders ON c_custkey = o_custkey\n            AND o_comment NOT LIKE '%special%requests%'\n        GROUP BY\n            c_custkey\n    ) AS c_orders\nGROUP BY\n    c_count\nORDER BY\n    custdist DESC,\n    c_count DESC;\n\n\nSELECT\n    --Query14\n    100.00 * SUM(\n        CASE\n            WHEN p_type LIKE 'PROMO%' THEN l_extendedprice * (1 - l_discount)\n            ELSE 0\n        END\n    ) / SUM(l_extendedprice * (1 - l_discount)) AS promo_revenue\nFROM\n    lineitem,\n    part\nWHERE\n    l_partkey = p_partkey AND l_shipdate >= cast( '1995-09-01' as date) AND l_shipdate < CAST('1995-10-01' AS date);\n\nSELECT\n    --Query15\n    s_suppkey,\n    s_name,\n    s_address,\n    s_phone,\n    total_revenue\nFROM\n    supplier,\n    (\n        SELECT\n            l_suppkey AS supplier_no,\n            SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\n        FROM\n            lineitem\n        WHERE\n            l_shipdate >= CAST('1996-01-01' AS date)\n            AND l_shipdate < CAST('1996-04-01' AS date)\n        GROUP BY\n            l_suppkey\n    ) revenue0\nWHERE\n    s_suppkey = supplier_no\n    AND total_revenue = (\n        SELECT\n            MAX(total_revenue)\n        FROM\n            (\n                SELECT\n                    l_suppkey AS supplier_no,\n                    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\n                FROM\n                    lineitem\n                WHERE\n                    l_shipdate >= CAST('1996-01-01' AS date)\n                    AND l_shipdate < CAST('1996-04-01' AS date)\n                GROUP BY\n                    l_suppkey\n            ) revenue1\n    )\nORDER BY\n    s_suppkey;\n\n\nSELECT\n    --Query16\n    p_brand,\n    p_type,\n    p_size,\n    COUNT(DISTINCT ps_suppkey) AS supplier_cnt\nFROM\n    partsupp,\n    part\nWHERE\n    p_partkey = ps_partkey\n    AND p_brand <> 'Brand#45'\n    AND p_type NOT LIKE 'MEDIUM POLISHED%'\n    AND p_size IN (\n        49,\n        14,\n        23,\n        45,\n        19,\n        3,\n        36,\n        9\n    )\n    AND ps_suppkey NOT IN (\n        SELECT\n            s_suppkey\n        FROM\n            supplier\n        WHERE\n            s_comment LIKE '%Customer%Complaints%'\n    )\nGROUP BY\n    p_brand,\n    p_type,\n    p_size\nORDER BY\n    supplier_cnt DESC,\n    p_brand,\n    p_type,\n    p_size;\n\n\nSELECT\n    --Query17\n    SUM(l_extendedprice) / 7.0 AS avg_yearly\nFROM\n    lineitem,\n    part\nWHERE\n    p_partkey = l_partkey\n    AND p_brand = 'Brand#23'\n    AND p_container = 'MED BOX'\n    AND l_quantity < (\n        SELECT\n            0.2 * AVG(l_quantity)\n        FROM\n            lineitem\n        WHERE\n            l_partkey = p_partkey\n    );\n\n\nSELECT\n    --Query18\n\ttop 100\n    c_name,\n    c_custkey,\n    o_orderkey,\n    o_orderdate,\n    o_totalprice,\n    SUM(l_quantity)\nFROM\n    customer,\n    orders,\n    lineitem\nWHERE\n    o_orderkey IN (\n        SELECT\n            l_orderkey\n        FROM\n            lineitem\n        GROUP BY\n            l_orderkey\n        HAVING\n            SUM(l_quantity) > 300\n    )\n    AND c_custkey = o_custkey\n    AND o_orderkey = l_orderkey\nGROUP BY\n    c_name,\n    c_custkey,\n    o_orderkey,\n    o_orderdate,\n    o_totalprice\nORDER BY\n    o_totalprice DESC,\n    o_orderdate;\n\n\nSELECT\n    --Query19\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM\n    lineitem,\n    part\nWHERE\n    (\n        p_partkey = l_partkey\n        AND p_brand = 'Brand#12'\n        AND p_container IN (\n            'SM CASE',\n            'SM BOX',\n            'SM PACK',\n            'SM PKG'\n        )\n        AND l_quantity >= 1\n        AND l_quantity <= 1 + 10\n        AND p_size BETWEEN 1\n        AND 5\n        AND l_shipmode IN ('AIR', 'AIR REG')\n        AND l_shipinstruct = 'DELIVER IN PERSON'\n    )\n    OR (\n        p_partkey = l_partkey\n        AND p_brand = 'Brand#23'\n        AND p_container IN (\n            'MED BAG',\n            'MED BOX',\n            'MED PKG',\n            'MED PACK'\n        )\n        AND l_quantity >= 10\n        AND l_quantity <= 10 + 10\n        AND p_size BETWEEN 1\n        AND 10\n        AND l_shipmode IN ('AIR', 'AIR REG')\n        AND l_shipinstruct = 'DELIVER IN PERSON'\n    )\n    OR (\n        p_partkey = l_partkey\n        AND p_brand = 'Brand#34'\n        AND p_container IN (\n            'LG CASE',\n            'LG BOX',\n            'LG PACK',\n            'LG PKG'\n        )\n        AND l_quantity >= 20\n        AND l_quantity <= 20 + 10\n        AND p_size BETWEEN 1\n        AND 15\n        AND l_shipmode IN ('AIR', 'AIR REG')\n        AND l_shipinstruct = 'DELIVER IN PERSON'\n    );\n\n\nSELECT\n    --Query20\n    s_name,\n    s_address\nFROM\n    supplier,\n    nation\nWHERE\n    s_suppkey IN (\n        SELECT\n            ps_suppkey\n        FROM\n            partsupp\n        WHERE\n            ps_partkey IN (\n                SELECT\n                    p_partkey\n                FROM\n                    part\n                WHERE\n                    p_name LIKE 'forest%'\n            )\n            AND ps_availqty > (\n                SELECT\n                    0.5 * SUM(l_quantity)\n                FROM\n                    lineitem\n                WHERE\n                    l_partkey = ps_partkey\n                    AND l_suppkey = ps_suppkey\n                    AND l_shipdate >= CAST('1994-01-01' AS date)\n                    AND l_shipdate < CAST('1995-01-01' AS date)\n            )\n    )\n    AND s_nationkey = n_nationkey\n    AND n_name = 'CANADA'\nORDER BY\n    s_name;\n\n\nSELECT\n    --Query21\n\ttop 100\n    s_name,\n    COUNT(*) AS numwait\nFROM\n    supplier,\n    lineitem l1,\n    orders,\n    nation\nWHERE\n    s_suppkey = l1.l_suppkey\n    AND o_orderkey = l1.l_orderkey\n    AND o_orderstatus = 'F'\n    AND l1.l_receiptdate > l1.l_commitdate\n    AND EXISTS (\n        SELECT\n            *\n        FROM\n            lineitem l2\n        WHERE\n            l2.l_orderkey = l1.l_orderkey\n            AND l2.l_suppkey <> l1.l_suppkey\n    )\n    AND NOT EXISTS (\n        SELECT\n            *\n        FROM\n            lineitem l3\n        WHERE\n            l3.l_orderkey = l1.l_orderkey\n            AND l3.l_suppkey <> l1.l_suppkey\n            AND l3.l_receiptdate > l3.l_commitdate\n    )\n    AND s_nationkey = n_nationkey\n    AND n_name = 'SAUDI ARABIA'\nGROUP BY\n    s_name\nORDER BY\n    numwait DESC,\n    s_name;\n\n\n\nSELECT\n    --Query22\n    cntrycode,\n    COUNT(*) AS numcust,\n    SUM(c_acctbal) AS totacctbal\nFROM\n    (\n        SELECT\n            SUBSTRING(c_phone, 1, 2) AS cntrycode,\n            c_acctbal\n        FROM\n            customer\n        WHERE\n            SUBSTRING(c_phone, 1, 2) IN (\n                '13',\n                '31',\n                '23',\n                '29',\n                '30',\n                '18',\n                '17'\n            )\n            AND c_acctbal > (\n                SELECT\n                    AVG(c_acctbal)\n                FROM\n                    customer\n                WHERE\n                    c_acctbal > 0.00\n                    AND SUBSTRING(c_phone, 1, 2) IN (\n                        '13',\n                        '31',\n                        '23',\n                        '29',\n                        '30',\n                        '18',\n                        '17'\n                    )\n            )\n            AND NOT EXISTS (\n                SELECT\n                    *\n                FROM\n                    orders\n                WHERE\n                    o_custkey = c_custkey\n            )\n    ) AS custsale\nGROUP BY\n    cntrycode\nORDER BY\n    cntrycode;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "tpc",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}